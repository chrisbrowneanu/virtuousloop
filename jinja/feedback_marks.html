{% extends "pdf.html" %}
{% block title %}{{ record.name|replace("_", " ") }}{% endblock %}
{% block author %}{% endblock %}
{% block date %}{% endblock %}"/>
{% block assignment_title %}{% endblock %}"/>
{% block content %}
    <h1>Feedback for {{ record.name|replace("_", " ") }} ({{ record.user }})</h1>

    {% if options_dict['crit_display']['graph'] == "True" %}
        <img src="../charts/{{ record.user|replace("_", " ") }}.png" alt=""/>
    {% endif %}

    {% for field_item in field_dict.items() %}
        {% for field in field_item %}
        <h3>{{ field.label }}</h3>
        {% if field.label %}
            <em>{{ field.description}}</em>
        {% endif %}
            {{ record[field.field]}}
        {% endfor %}
    {% endfor %}
        {% if options_dict['rubric_display']['rubric_new_page'] == "True" %}
            <hr class="new-page" />
        {% endif %}
        <h2>{{ options_dict['pdf_messages']['rubric_title'] }}</h2>
        <em>{{ options_dict['pdf_messages']['rubric_note'] }}</em>
        <table class="rubric">
            <tr>
                <th>Criteria</th>
                {% for k, level in levels_dict.items() %}
                    {% if level['rubric'] == "show" %}
                        <th>{{ level['text'] }}</th>
                    {% endif %}
                {% endfor %}
            </tr>
            {% for k, crit in crit_dict.items() %}
                {% set this_field = crit['field'] + "_desc" %}
                {% set this_record_level = record[crit['field']] %}
            <tr>
                <th>{{ crit['label'] }}<br />({{ crit['weight'] }})</th>
                {% for k, level in levels_dict.items() %}
                    {% set this_level = level['index'] %}
                    {% if this_record_level == level['class1'] and this_record_level == level['class2'] %}
                        {% set class = "flag100" %}
                    {% elif this_record_level == level['class1'] or this_record_level == level['class2'] %}
                        {% set class = "flag50" %}
                    {% else %}
                        {% set class = "flag0" %}
                    {% endif %}
                    this_crit {{ crit['field'] }}
                    this_level {{ this_level }} | 
                    this_record_level {{ this_record_level }} | 
                    level_class1 {{ level['class1'] }}
                    level_class2 {{ level['class2'] }}
                    this_class {{ class }}
                    <br />
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
{% endblock %}
