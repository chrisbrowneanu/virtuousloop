{% extends "pdf.html" %}
{% block title %}{{ record.name|replace("_", " ") }}{% endblock %}
{% block author %}{% endblock %}
{% block date %}{% endblock %}"/>
{% block assignment_title %}{% endblock %}"/>
{% block content %}
    <h1>Feedback for {{ record.name|replace("_", " ") }} ({{ record.user }})</h1>

    {% if options_dict['crit_display']['graph'] == "True" %}
        <img src="../charts/{{ record.user|replace("_", " ") }}.png" alt=""/>
    {% endif %}

    {% for field_item in field_dict.items() %}
        {% for field in field_item %}
        <h3>{{ field.label }}</h3>
        {% if field.label %}
            <em>{{ field.description}}</em>
        {% endif %}
            {{ record[field.field]}}
        {% endfor %}
    {% endfor %}
        {% if options_dict['rubric_display']['rubric_new_page'] == "True" %}
            <hr class="new-page" />
        {% endif %}
        <h2>{{ options_dict['pdf_messages']['rubric_title'] }}</h2>
        <em>{{ options_dict['pdf_messages']['rubric_note'] }}</em>
        <table class="rubric">
            <tr>
                <th>Criteria</th>
                {% for k, level in levels_dict.items() %}
                    {% if level['rubric'] == "show" %}
                        <th>{{ level['text'] }}</th>
                    {% endif %}
                {% endfor %}
            </tr>
            {% for k, crit in crit_dict.items() %}
                {% set this_field = crit['field'] + "_desc" %}
                {% set this_record_level = record['index'] %}
            <tr>
                <th>{{ crit['label'] }}<br />({{ crit['weight'] }})</th>
                {% for level_key, level_val in levels_dict.items() %}
                    {% if level_val['rubric'] == "show" %}
                        {% if level_key[record[crit['field']]] == level_val['class1'] or level_key[record[crit['field']]] == level_val['class2'] %}
                            {% set this_class = "flag50" %}  
                        {% endif %}
                        <td class="{{this_class}}">
                            record {{ record[crit['field']] }}
                            level key {{ levels_dict[record['crit_field']] }}
                            level val {{ level_val['class1'] }}
                            this_field {{ level_val[this_field] }}
                        </td>
                    {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
{% endblock %}
